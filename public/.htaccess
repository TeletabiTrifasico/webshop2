<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Handle API requests
    RewriteCond %{REQUEST_URI} ^/api/
    RewriteRule ^ index.php [L]

    # Allow direct access to dist directory
    RewriteCond %{REQUEST_URI} ^/dist/
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ - [L]

    # Serve the index.html for all other routes
    RewriteRule ^ index.html [L]
</IfModule>

# Proper MIME types
AddType application/javascript .js
AddType application/javascript .mjs
AddType text/css .css

# Headers
<FilesMatch "\.(js|mjs)$">
    Header set Content-Type "application/javascript"
</FilesMatch>

<FilesMatch "\.css$">
    Header set Content-Type "text/css"
</FilesMatch>

# CORS Headers
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header set Access-Control-Allow-Headers "Content-Type, Authorization"